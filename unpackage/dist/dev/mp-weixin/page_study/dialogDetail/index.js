require('../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["page_study/dialogDetail/index"],{280:function(e,t,n){"use strict";(function(e,t){var o=n(4);n(26);o(n(25));var i=o(n(281));e.__webpack_require_UNI_MP_PLUGIN__=n,t(i.default)}).call(this,n(1)["default"],n(2)["createPage"])},281:function(e,t,n){"use strict";n.r(t);var o=n(282),i=n(284);for(var u in i)["default"].indexOf(u)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(u);n(287);var r,c=n(32),s=Object(c["default"])(i["default"],o["render"],o["staticRenderFns"],!1,null,"7cbcb514",null,!1,o["components"],r);s.options.__file="page_study/dialogDetail/index.vue",t["default"]=s.exports},282:function(e,t,n){"use strict";n.r(t);var o=n(283);n.d(t,"render",(function(){return o["render"]})),n.d(t,"staticRenderFns",(function(){return o["staticRenderFns"]})),n.d(t,"recyclableRender",(function(){return o["recyclableRender"]})),n.d(t,"components",(function(){return o["components"]}))},283:function(e,t,n){"use strict";var o;n.r(t),n.d(t,"render",(function(){return i})),n.d(t,"staticRenderFns",(function(){return r})),n.d(t,"recyclableRender",(function(){return u})),n.d(t,"components",(function(){return o}));try{o={uSubsection:function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u-subsection/u-subsection")]).then(n.bind(null,453))},uCellGroup:function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u-cell-group/u-cell-group")]).then(n.bind(null,546))},uCell:function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u-cell/u-cell")]).then(n.bind(null,554))},uIcon:function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/uview-ui/components/u-icon/u-icon")]).then(n.bind(null,471))}}}catch(c){if(-1===c.message.indexOf("Cannot find module")||-1===c.message.indexOf(".vue"))throw c;console.error(c.message),console.error("1. 排查组件名称拼写是否正确"),console.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var i=function(){var e=this,t=e.$createElement,n=(e._self._c,e.iscontent?e.__map(e.detailList,(function(t,n){var o=e.__get_orig(t),i=e.getFile(t.mp3);return{$orig:o,m0:i}})):null);e._isMounted||(e.e0=function(t){e.type=2},e.e1=function(t){e.type=6}),e.$mp.data=Object.assign({},{$root:{l0:n}})},u=!1,r=[];i._withStripped=!0},284:function(e,t,n){"use strict";n.r(t);var o=n(285),i=n.n(o);for(var u in o)["default"].indexOf(u)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(u);t["default"]=i.a},285:function(e,t,n){"use strict";(function(e,o){var i=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u=i(n(55)),r=i(n(57)),c=i(n(18)),s=n(162),a=n(163),l=n(286),d=function(){n.e("components/audioView/index").then(function(){return resolve(n(629))}.bind(null,n)).catch(n.oe)},f=e.getRecorderManager(),p={components:{audioView:d},data:function(){return{list:["关键词","对话"],current:0,message:[],iscontent:!1,btRecoding:!1,is_clock:!1,theme:"",audio_path:"",startPoint:"",audioContext:"",detail:"",nums:0,type:1,evaluates:[],detailList:[]}},computed:{dialog:function(){var e=[];return this.message.length>0&&(this.message.sort((function(e,t){return e.sub_sequence-t.sub_sequence})),e=(0,s.groupBy)(this.message,"topic")),e},score:function(){var e=this.evaluates.reduce((function(e,t){return e+t.fluency}),0),t=this.evaluates.reduce((function(e,t){return e+t.integrity}),0),n=this.evaluates.reduce((function(e,t){return e+t.pronunciation}),0),o=this.evaluates.reduce((function(e,t){return e+t.score}),0),i={};return i.fluency=e/this.evaluates.length,i.integrity=t/this.evaluates.length,i.pronunciation=n/this.evaluates.length,i.score=o/this.evaluates.length,console.log(i),i},keyWords:function(){console.log(this.dialog);var e=Object.values(this.dialog),t=[];return e.map((function(e){t.push.apply(t,(0,c.default)(e[0].keywords.match(/(?<=\.)(.+?)(?=（)/g)))})),t}},methods:{change:function(e){this.current=e,0==e&&(this.iscontent=!1)},getFile:function(e){return"https://cloud-minapp-45998.cloud.ifanrusercontent.com/"+e},goback:function(){this.iscontent=!1,this.type=1},toDetail:function(e){this.iscontent=!0,console.log(e),this.detailList=this.dialog[e]},beginRead:function(){this.type=3,this.palyAudio(this.detailList[this.nums].mp3)},palyAudio:function(t){var n=this.audioContext=e.createInnerAudioContext();n.src="https://cloud-minapp-45998.cloud.ifanrusercontent.com/"+t,n.play(),n.onPlay((function(){console.log("开始播放")}))},showD:function(){var e=this;return(0,r.default)(u.default.mark((function t(){var n,o;return u.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,(0,l.evaluateAudio)(e.audio_path,e.detailList[e.nums+1].sentence);case 2:return n=t.sent,o=JSON.parse(n[1].data),console.log(o),4==e.type&&e.evaluates.pop(),e.evaluates.push(o),console.log(e.nums),console.log(e.detailList.length),t.abrupt("return",1*o.score);case 10:case"end":return t.stop()}}),t)})))()},handleRecordStart:function(e){this.btRecoding=!0,this.is_clock=!0,this.startPoint=e.touches[0];var t={duration:1e4,format:"mp3"};f.start(t),f.onStart((function(e){console.log("开始录音")}))},handleRecordStop:function(e){var t=this;if(f.stop(),this.btRecoding=!1,!0===this.is_clock){f.onStop(function(){var e=(0,r.default)(u.default.mark((function e(n){var i;return u.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(n.duration<2e3)){e.next=4;break}o.showToast({title:"录音时间太短，请长按录音",icon:"none",duration:1e3}),e.next=9;break;case 4:return t.audio_path=n.tempFilePath,e.next=7,t.showD();case 7:i=e.sent,i>50||4==t.type?(t.type=3,t.nums+=2,t.nums>=t.detailList.length-1&&(t.type=5),t.palyAudio(t.detailList[t.nums].mp3)):t.type=4;case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},handleTouchMove:function(e){Math.abs(e.touches[e.touches.length-1].clientY-this.startPoint.clientY)>25?this.is_clock=!1:this.is_clock=!0},startRecord:function(){var e={format:"mp3"};recorder.start(e),recorder.onStart((function(){console.log("开始录音")}))},stopRecord:function(){var e=this;recorder.stop(),recorder.onStop((function(t){e.audio_path=t.tempFilePath}))}},watch:{},onLoad:function(t){var n=this;a.query.queryObject.$and=[],a.query.contains("text_name",t.lesson),a.learn_information_MCTdialogue.setQuery(a.query).limit(1e3).find().then((function(e){n.message=e.data.objects})),e.setNavigationBarTitle({title:t.lesson})},onReady:function(){},onShow:function(){(0,a.updateUserAction)("count_word",1)},onHide:function(){},onUnload:function(){(0,a.updateUserAction)("num_word",this.keyWords.length)}};t.default=p}).call(this,n(2)["default"],n(1)["default"])},287:function(e,t,n){"use strict";n.r(t);var o=n(288),i=n.n(o);for(var u in o)["default"].indexOf(u)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(u);t["default"]=i.a},288:function(e,t,n){}},[[280,"common/runtime","common/vendor","page_study/common/vendor"]]]);